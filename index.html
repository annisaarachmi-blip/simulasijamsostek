<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulasi Iuran BPJS Ketenagakerjaan</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700&display=swap" rel="stylesheet">

<style>
/* ================= BASE ================= */
body{
  font-family:'Nunito Sans',sans-serif;
  background:#f4f6f9;
  margin:0;
  padding:10px;
}
.btn-reset{
  background:#dc2626;
}
.actions{
  display:flex;
  gap:12px;
}
.actions button{
  width:100%;
}
.container{
  max-width:960px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:14px;
}

h2{
  text-align:center;
  color:#0a4fb3;
  font-size:22px;
  margin-bottom:10px;
}

h3{margin-top:0}

.section{
  border:1px solid #ddd;
  padding:16px;
  margin-top:20px;
  border-radius:14px;
}

.hidden{display:none}

label{
  display:block;
  margin-top:10px;
  font-size:14px;
}

input,select,button{

  box-sizing:border-box;
  padding:10px;
  margin-top:6px;
  font-size:14px;
}

button{
  background:#0a4fb3;
  color:#fff;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin-top:16px;
}

#rekapProgram h3{
  margin-top:0;
}


/* ================= CHECKBOX CARD ================= */
.checkbox-row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-top:12px;
}

.checkbox-card{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 14px;
  border-radius:12px;
  border:1.5px solid #d6dbe3;
  background:#f8f9fb;
  cursor:pointer;
  transition:.2s ease;
}

.checkbox-card input{
  width:18px;
  height:18px;
  margin:0;
  accent-color:#0a4fb3;
}

.checkbox-card.active{
  background:#eaf2ff;
  border-color:#0a4fb3;
  color:#0a4fb3;
  font-weight:600;
}

.checkbox-card.disabled{
  opacity:.45;
  cursor:not-allowed;
}

/* ================= TABLE ================= */
.table-wrap{overflow-x:auto}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
  min-width:700px;
}

th,td{
  border:1px solid #ccc;
  padding:8px;
  text-align:center;
  font-size:13px;
}

th{background:#f1f5ff}

.summary{
  background:#eef6ff;
  padding:14px;
  margin-top:15px;
  border-left:5px solid #0a4fb3;
  font-size:14px;
}

.footer-note{
  text-align:center;
  font-size:12px;
  color:#888;
  margin-top:30px;
}

@media(max-width:600px){
  .checkbox-row{grid-template-columns:1fr}
  h2{font-size:20px}
}

/* ================= FOOTER TABLE MOBILE ================= */
.footer-table table{
  min-width:auto; /* override */
}

@media(max-width:600px){
  .footer-table th,
  .footer-table td{
    font-size:12px;
    padding:6px;
  }

  .footer h4{
    font-size:15px;
    margin-bottom:6px;
  }

  .footer h5{
    font-size:12px;
    text-align:center;
    color:#555;
  }
}

</style>
</head>

<body>
<div class="container">

<h2>Simulasi Penganggaran<br>Jaminan Sosial Ketenagakerjaan</h2>

<!-- ================= METODE ================= -->
<div class="section">
  <label>Metode Simulasi</label>
  <select id="metode">
    <option value="">-- Pilih Metode --</option>
    <option value="sasaran">Sesuai Sasaran</option>
    <option value="anggaran">Sesuai Ketersediaan Anggaran</option>
  </select>
</div>

<!-- ================= SASARAN ================= -->
<div id="boxSasaran" class="section hidden">
  <h3>Simulasi Sesuai Sasaran</h3>

  <label>Jenis Sasaran</label>
  <div class="checkbox-row">
    <div class="checkbox-card" id="cardPU"><input type="checkbox" id="s_nonasn"> PU</div>
    <div class="checkbox-card" id="cardBPU"><input type="checkbox" id="s_bpu"> BPU (Pekerja Rentan)</div>
  </div>

  <!-- PU -->
  <div id="sasaranNonASN" class="hidden">
    <h4>PU</h4>
	    <label>Upah (Rp)</label>
    <input type="text" id="upahS" class="input-number" value="3.000.000">

    <label>Jumlah Orang</label>
    <input type="text" id="orgSNon" class="input-number" value="100">

    <label>Bulan Perlindungan</label>
    <input type="text" id="blnSNon" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTPU"><input type="checkbox" id="jhtSNon"> Tambah JHT 5,7%</div>
      <div class="checkbox-card disabled" id="cardJPPU"><input type="checkbox" id="jpSNon" disabled> Tambah JP 3%</div>
    </div>
  </div>

  <!-- BPU -->
  <div id="sasaranBPU" class="hidden">
    <h4>BPU (Pekerja Rentan)</h4>

    <label>Jumlah Orang</label>
    <input type="text" id="orgSBPU" class="input-number" value="100">

    <label>Bulan Perlindungan</label>
    <input type="text" id="blnSBPU" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTBPU"><input type="checkbox" id="jhtSBPU"> Tambah JHT (Rp20.000)</div>
    </div>
  </div>

  <button onclick="hitungSasaran()">Hitung</button>
  <button type="button" class="btn-reset" onclick="resetSimulasi()">Reset</button>

</div>

<!-- ================= ANGGARAN ================= -->
<div id="boxAnggaran" class="section hidden">
  <h3>Simulasi Sesuai Ketersediaan Anggaran</h3>

  <label>Total Anggaran (Rp)</label>
  <input type="text" id="totalAnggaran" class="input-number">

  <label>Jenis Sasaran</label>
  <div class="checkbox-row">
    <div class="checkbox-card" id="cardPUA"><input type="checkbox" id="a_nonasn"> PU</div>
    <div class="checkbox-card" id="cardBPUA"><input type="checkbox" id="a_bpu"> BPU (Pekerja Rentan)</div>
  </div>

  <label>Tujuan Perhitungan</label>
  <select id="tujuan">
    <option value="">-- Pilih --</option>
    <option value="orang">Mencari Jumlah Orang</option>
    <option value="bulan">Mencari Bulan Perlindungan</option>
  </select>

  <!-- PU Anggaran -->
  <div id="angNonASN" class="hidden">
    <h4>PU</h4>

    <label>Upah (Rp)</label>
    <input type="text" id="upahA" class="input-number" value="3.000.000">

    <label id="lblOrgA">Jumlah Orang</label>
    <input type="text" id="orgA" class="input-number" value="100">

    <label id="lblBlnA">Bulan Perlindungan</label>
    <input type="text" id="blnA" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTA"><input type="checkbox" id="jhtA"> Tambah JHT 5,7%</div>
      <div class="checkbox-card disabled" id="cardJPA"><input type="checkbox" id="jpA" disabled> Tambah JP 3%</div>
    </div>
  </div>

  <!-- BPU Anggaran -->
  <div id="angBPU" class="hidden">
    <h4>BPU (Pekerja Rentan)</h4>

    <label id="lblOrgB">Jumlah Orang</label>
    <input type="text" id="orgB" class="input-number" value="100">

    <label id="lblBlnB">Bulan Perlindungan</label>
    <input type="text" id="blnB" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTBA"><input type="checkbox" id="jhtB"> Tambah JHT (Rp20.000)</div>
    </div>
  </div>

  <button onclick="hitungAnggaran()">Hitung</button>
  <button type="button" class="btn-reset" onclick="resetSimulasi()">Reset</button>
</div>

<!-- ================= HASIL ================= -->
<div id="hasil" class="section hidden">
  <h3>Hasil Simulasi</h3>

  <div class="table-wrap">
    <table id="tabel">
      <tr>
        <th>Jenis</th>
        <th>Orang</th>
        <th>Bulan</th>
        <th>Iuran / Bulan</th>
        <th>Total</th>
      </tr>
    </table>
  </div>

  <div class="summary" id="kesimpulan"></div>
  <div id="rekapProgram" class="section hidden">
  <h3>Rekap Iuran per Program</h3>

  <div class="table-wrap">
    <table id="tabelRekap">
      <tr>
        <th>Program</th>
        <th id="colPU">PU</th>
        <th id="colBPU">BPU</th>
        <th>Total</th>
      </tr>
    </table>
  </div>
</div>
</div>

<div class="footer">
  <h4>Skema Iuran</h4>
  <div class="table-wrap footer-table">
    <table>
      <tr><th>Program</th><th>PU</th><th>BPU</th></tr>
      <tr><td>JKK + JKM</td><td>0,54% Upah</td><td>Rp16.800</td></tr>
      <tr><td>JHT</td><td>5,7% Upah</td><td>Rp20.000</td></tr>
      <tr><td>JP</td><td>3% Upah</td><td>-</td></tr>
    </table>
  </div>

  <h5 style="margin-top:8px">Minimal 2 Program Wajib (JKK + JKM)</h5>
</div>

<div class="footer-note">Â© 2026. BPJS Ketenagakerjaan Kantor Wilayah Jawa Timur</div>

</div>

<script>
/* ================= UTIL ================= */
const format=n=>Number(n||0).toLocaleString('id-ID');
const getNum=id=>parseInt(document.getElementById(id).value.replace(/\./g,''))||0;

/* format input */
document.addEventListener('input',e=>{
  if(e.target.classList.contains('input-number')){
    let raw=e.target.value.replace(/[^0-9]/g,'');
    e.target.value=format(raw);
  }
});

/* ================= METODE ================= */
metode.onchange=()=>{
  boxSasaran.classList.add('hidden');
  boxAnggaran.classList.add('hidden');
  hasil.classList.add('hidden');
  if(metode.value==='sasaran')boxSasaran.classList.remove('hidden');
  if(metode.value==='anggaran')boxAnggaran.classList.remove('hidden');
};

/* ================= TOGGLE SASARAN ================= */
s_nonasn.onchange=()=>{
  cardPU.classList.toggle('active',s_nonasn.checked);
  sasaranNonASN.classList.toggle('hidden',!s_nonasn.checked);
};

s_bpu.onchange=()=>{
  cardBPU.classList.toggle('active',s_bpu.checked);
  sasaranBPU.classList.toggle('hidden',!s_bpu.checked);
};

/* JHT â†’ JP PU */
jhtSNon.onchange=()=>{
  cardJHTPU.classList.toggle('active',jhtSNon.checked);
  jpSNon.disabled=!jhtSNon.checked;
  cardJPPU.classList.toggle('disabled',!jhtSNon.checked);
  if(!jhtSNon.checked){jpSNon.checked=false;cardJPPU.classList.remove('active')}
};

jpSNon.onchange=()=>cardJPPU.classList.toggle('active',jpSNon.checked);

jhtSBPU.onchange=()=>cardJHTBPU.classList.toggle('active',jhtSBPU.checked);

/* ================= TOGGLE ANGGARAN ================= */
a_nonasn.onchange=()=>{
  cardPUA.classList.toggle('active',a_nonasn.checked);
  angNonASN.classList.toggle('hidden',!a_nonasn.checked);
};

a_bpu.onchange=()=>{
  cardBPUA.classList.toggle('active',a_bpu.checked);
  angBPU.classList.toggle('hidden',!a_bpu.checked);
};

jhtA.onchange=()=>{
  cardJHTA.classList.toggle('active',jhtA.checked);
  jpA.disabled=!jhtA.checked;
  cardJPA.classList.toggle('disabled',!jhtA.checked);
  if(!jhtA.checked){jpA.checked=false;cardJPA.classList.remove('active')}
};

jpA.onchange=()=>cardJPA.classList.toggle('active',jpA.checked);

jhtB.onchange=()=>cardJHTBA.classList.toggle('active',jhtB.checked);

/* tujuan */
tujuan.onchange=()=>{
  const orang=tujuan.value==='bulan';
  lblOrgA.style.display=orang?'block':'none';
  orgA.style.display=orang?'block':'none';
  lblOrgB.style.display=orang?'block':'none';
  orgB.style.display=orang?'block':'none';
  lblBlnA.style.display=orang?'none':'block';
  blnA.style.display=orang?'none':'block';
  lblBlnB.style.display=orang?'none':'block';
  blnB.style.display=orang?'none':'block';
};

/* ================= HITUNG ================= */
function hitungSasaran(){
  
  tabel.innerHTML=tabel.rows[0].outerHTML;
  let total=0;

  if(s_nonasn.checked){
    let up=getNum('upahS'),org=getNum('orgSNon'),bln=getNum('blnSNon');
    let tarif=0.0054+(jhtSNon.checked?0.057:0)+(jpSNon.checked?0.03:0);
    let per=up*tarif,sub=per*org*bln;total+=sub;
    tabel.innerHTML+=`<tr><td>PU</td><td>${format(org)}</td><td>${format(bln)}</td><td>Rp ${format(per)}</td><td>Rp ${format(sub)}</td></tr>`;
  }

  if(s_bpu.checked){
    let org=getNum('orgSBPU'),bln=getNum('blnSBPU');
    let per=16800+(jhtSBPU.checked?20000:0),sub=per*org*bln;total+=sub;
    tabel.innerHTML+=`<tr><td>BPU</td><td>${format(org)}</td><td>${format(bln)}</td><td>Rp ${format(per)}</td><td>Rp ${format(sub)}</td></tr>`;
  }

  tabel.innerHTML+=`<tr><th colspan="4">TOTAL</th><th>Rp ${format(total)}</th></tr>`;
  kesimpulan.innerHTML=`Hasil simulasi menunjukkan kebutuhan anggaran sebesar <b>Rp ${format(total)}</b> untuk mendukung perlindungan jaminan sosial ketenagakerjaan sesuai skema yang dipilih.`;
  
  let rekapPU = {};
let rekapBPU = {};

// PU
if(s_nonasn.checked){
  let up = getNum('upahS');
  let org = getNum('orgSNon');
  let bln = getNum('blnSNon');

  rekapPU.JKK = up * 0.0024 * org * bln;
  rekapPU.JKM = up * 0.003 * org * bln;
  if(jhtSNon.checked) rekapPU.JHT = up * 0.057 * org * bln;
  if(jpSNon.checked) rekapPU.JP  = up * 0.03  * org * bln;
}

// BPU
if(s_bpu.checked){
  let org = getNum('orgSBPU');
  let bln = getNum('blnSBPU');

  rekapBPU.JKK = 16800 * org * bln;
  if(jhtSBPU.checked) rekapBPU.JHT = 20000 * org * bln;
}

tampilkanRekap({ pu: rekapPU, bpu: rekapBPU });

  
  hasil.classList.remove('hidden');
}

function hitungAnggaran(){

  tabel.innerHTML = tabel.rows[0].outerHTML;
  let ang = getNum('totalAnggaran');
  let bagian = (a_nonasn.checked && a_bpu.checked) ? ang/2 : ang;
  let total = 0;

  let rekapPU = {};
  let rekapBPU = {};

  /* ================= PU ================= */
  if(a_nonasn.checked){
    let up = getNum('upahA');
    let org = getNum('orgA');
    let bln = getNum('blnA');

    let tarifJKK = 0.0024;
    let tarifJKM = 0.003;
    let tarifJHT = jhtA.checked ? 0.057 : 0;
    let tarifJP  = jpA.checked  ? 0.03  : 0;

    let tarifTotal = tarifJKK + tarifJKM + tarifJHT + tarifJP;

    if(tujuan.value === 'orang'){
      let biayaPerOrg = up * tarifTotal * bln;
      org = Math.floor(bagian / biayaPerOrg);
    }else{
      let biayaPerBln = up * tarifTotal * org;
      bln = Math.floor(bagian / biayaPerBln);
    }

    let sub = up * tarifTotal * org * bln;
    total += sub;

    /* ðŸ”¹ REKAP PU */
    rekapPU.JKK = up * tarifJKK * org * bln;
    rekapPU.JKM = up * tarifJKM * org * bln;
    if(jhtA.checked) rekapPU.JHT = up * tarifJHT * org * bln;
    if(jpA.checked)  rekapPU.JP  = up * tarifJP  * org * bln;

    tabel.innerHTML += `
      <tr>
        <td>PU</td>
        <td>${format(org)}</td>
        <td>${format(bln)}</td>
        <td>Rp ${format(up * tarifTotal)}</td>
        <td>Rp ${format(sub)}</td>
      </tr>
    `;
  }

  /* ================= BPU ================= */
  if(a_bpu.checked){
    let org = getNum('orgB');
    let bln = getNum('blnB');

    let tarifJKKJKM = 16800;
    let tarifJHT = jhtB.checked ? 20000 : 0;
    let tarifTotal = tarifJKKJKM + tarifJHT;

    if(tujuan.value === 'orang'){
      org = Math.floor(bagian / (tarifTotal * bln));
    }else{
      bln = Math.floor(bagian / (tarifTotal * org));
    }

    let sub = tarifTotal * org * bln;
    total += sub;

    /* ðŸ”¹ REKAP BPU */
    rekapBPU.JKK = tarifJKKJKM * org * bln;
    if(jhtB.checked) rekapBPU.JHT = tarifJHT * org * bln;

    tabel.innerHTML += `
      <tr>
        <td>BPU</td>
        <td>${format(org)}</td>
        <td>${format(bln)}</td>
        <td>Rp ${format(tarifTotal)}</td>
        <td>Rp ${format(sub)}</td>
      </tr>
    `;
  }

  let sisa = ang - total;

  tabel.innerHTML += `
    <tr>
      <th colspan="4">SISA ANGGARAN</th>
      <th>Rp ${format(sisa)}</th>
    </tr>
  `;

  kesimpulan.innerHTML = `
    Total anggaran <b>Rp ${format(ang)}</b>,
    digunakan <b>Rp ${format(total)}</b>,
    sisa <b>Rp ${format(sisa)}</b>.
  `;

  /* ðŸ”¥ INI KUNCI REKAP */
  tampilkanRekap({
    pu: rekapPU,
    bpu: rekapBPU
  });

  hasil.classList.remove('hidden');
}


function tampilkanRekap({pu={}, bpu={}}){
  tabelRekap.innerHTML = `
    <tr>
      <th>Program</th>
      <th id="colPU">PU</th>
      <th id="colBPU">BPU</th>
      <th>Total</th>
    </tr>
  `;

  const program = ['JKK','JKM','JHT','JP'];
  let grandTotal = 0;

  program.forEach(p=>{
    let valPU = pu[p] || 0;
    let valBPU = bpu[p] || 0;
    let total = valPU + valBPU;
    grandTotal += total;

    tabelRekap.innerHTML += `
      <tr>
        <td>${p}</td>
        <td>${valPU ? 'Rp ' + format(valPU) : '-'}</td>
        <td>${valBPU ? 'Rp ' + format(valBPU) : '-'}</td>
        <td><b>Rp ${format(total)}</b></td>
      </tr>
    `;
  });

 let colSpanTotal = 1;
if(Object.keys(pu).length > 0) colSpanTotal++;
if(Object.keys(bpu).length > 0) colSpanTotal++;

tabelRekap.innerHTML += `
  <tr>
    <th colspan="${colSpanTotal}">TOTAL</th>
    <th>Rp ${format(grandTotal)}</th>
  </tr>
`;

  // hide kolom PU / BPU jika tidak dipilih
  if(Object.keys(pu).length === 0){
    document.querySelectorAll('#colPU, #tabelRekap td:nth-child(2)').forEach(e=>e.style.display='none');
  }
  if(Object.keys(bpu).length === 0){
    document.querySelectorAll('#colBPU, #tabelRekap td:nth-child(3)').forEach(e=>e.style.display='none');
  }

  rekapProgram.classList.remove('hidden');
}

function resetSimulasi(){
  window.location.reload();
}
</script>
</body>
</html>

