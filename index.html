<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulasi Iuran BPJS Ketenagakerjaan</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700&display=swap" rel="stylesheet">

<style>
/* ================= LOGO ATAS KANAN ================= */
.logo-top-right {
  display: flex;
  justify-content: flex-end; /* kanan */
  margin-bottom: 6px;
}

.logo-top-right img {
  width: 120px;    /* agak besar */
  height: auto;
}
/* baris utama */
.row-pengguna{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

/* checkbox tetap sejajar */
.row-pengguna .checkbox-row{
  display: flex;
  gap: 10px;
}

/* tombol reset kecil & sejajar */
.btn-reset-inline{
  background: #dc2626;
  color: white;
  border: none;
  border-radius: 10px;
  padding: 8px 14px;
  font-size: 12px;
  cursor: pointer;
  white-space: nowrap;
  margin-top: 0;

}



/* ================= MOBILE ================= */

@media (max-width:600px){
  .row-pengguna{
    flex-direction:column;
    align-items:flex-start;
    gap:8px;
  }

  .row-pengguna .checkbox-row{
    width:100%;
  }

  .btn-reset-inline{
    align-self:flex-start; /* üîπ reset di bawah kiri */
    margin-top:0;
  }
}


@media (max-width: 600px) {
  .logo-top-right img {
    width: 90px;   /* sedikit lebih kecil di HP */
  }
}
/* ================= BASE ================= */
body{
  font-family:'Nunito Sans',sans-serif;
  background:#f4f6f9;
  margin:0;
  padding:10px;
}
.btn-reset{
  background:#dc2626;
}
.actions{
  display:flex;
  gap:12px;
}
.actions button{
  width:100%;
}
.container{
  max-width:960px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:14px;
}

h2{
  text-align:center;
  color:#0a4fb3;
  font-size:22px;
  margin-bottom:10px;
}

h3{margin-top:0}

.section{
  border:1px solid #ddd;
  padding:12px;
  margin-top:14px;
  border-radius:14px;
}

.hidden{display:none}

label{
  display:block;
  margin-top:10px;
  font-size:14px;
}

input,select,button{

  box-sizing:border-box;
  padding:10px;
  margin-top:6px;
  font-size:14px;
}

button{
  background:#0a4fb3;
  color:#fff;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin-top:16px;
}

#rekapProgram h3{
  margin-top:0;
  margin-bottom:4px; 
}


/* ================= CHECKBOX CARD ================= */
.checkbox-row{
  display: flex;
  flex-wrap: wrap;
  gap:10px;
}


.checkbox-card{
  display:flex;
  align-items:center;
  gap:8px;
  padding:8px 10px;      /* ‚¨ÖÔ∏è lebih kecil */
  border-radius:10px;
  border:1.3px solid #d6dbe3;
  background:#f8f9fb;
  cursor:pointer;
  transition:.2s ease;
  font-size:12px;        /* ‚¨ÖÔ∏è lebih kecil */
}

.checkbox-card{
  width: fit-content;          /* ‚¨ÖÔ∏è kunci utama */
  min-width: unset;
}
.sektor-bpu .checkbox-card{
  width: fit-content;
  padding:6px 10px;
  font-size:12px;
}


.checkbox-card input{
  width:16px;
  height:16px;
}


.checkbox-card input{
  width:18px;
  height:18px;
  margin:0;
  accent-color:#0a4fb3;
}

.checkbox-card.active{
  background:#eaf2ff;
  border-color:#0a4fb3;
  color:#0a4fb3;
  font-weight:600;
}

.checkbox-card.disabled{
  opacity:.45;
  cursor:not-allowed;
}
/* khusus sektor BPU: 1 baris kiri-kanan */
.sektor-bpu{
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;        /* ‚¨ÖÔ∏è jangan turun baris */
  gap: 12px;
  align-items: center;
}

/* kecil & rapi */
.sektor-bpu .checkbox-card{
  width: fit-content;
  padding: 6px 12px;
  font-size: 12px;
  white-space: nowrap;      /* ‚¨ÖÔ∏è cegah teks turun */
}


/* ================= TABLE ================= */
.table-wrap{overflow-x:auto}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:6px;
  min-width:700px;
}

th,td{
  border:1px solid #ccc;
  padding:6px 8px;     /* ‚¨ÖÔ∏è lebih rapat */
  text-align:center;
  font-size:13px;
}

th{background:#f1f5ff}

.summary{
  background:#eef6ff;
  padding:14px;
  margin-top:15px;
  border-left:5px solid #0a4fb3;
  font-size:14px;
}


.footer-note{
  text-align:center;
  font-size:12px;
  color:#888;
  margin-top:30px;
}

@media(max-width:600px){
  .checkbox-row{grid-template-columns:1fr}
  h2{font-size:20px}
}

/* ================= HASIL SIMULASI & REKAP ================= */
#hasil {
  border: 2px solid #000;   /* ‚¨ÖÔ∏è border hitam tebal */
  padding: 12px;            /* tetap nyaman di dalam */
  border-radius: 14px;      /* sudut bulat */
}

/* ================= REKAP IURAN PER PROGRAM ================= */
#rekapProgram {
  padding: 16px;             /* ruang di dalam kotak */
  border-radius: 14px;       /* sudut bulat */
  background: #fff;          /* latar putih */
  width: 80%;                /* lebar kotak */
  min-width: 400px;          /* minimal lebar supaya tabel muat */
  max-width: 900px;          /* maksimal lebar */
  min-height: 200px;         /* tinggi minimal kotak */
  margin: 14px 0;            /* atas & bawah ada jarak, kiri kanan 0 = kiri */
}
/* ================= RESPONSIF MOBILE ================= */
@media (max-width: 600px) {
  #rekapProgram {
    width: 100%;             /* full width di mobile */
    padding: 12px;           /* padding lebih kecil */
    margin-left: 0;           /* rata kiri */
    margin-right: 0;          /* rata kiri */
    box-sizing: border-box;
  }

  /* wrapper tabel scrollable */
  #rekapProgram .table-wrap {
    overflow-x: auto;        /* scroll jika tabel tetap lebar */
  }

  #rekapProgram table {
    width: 100%;             /* tabel ikut lebar kotak */
    min-width: 0;
    table-layout: auto;
  }

  #rekapProgram th, #rekapProgram td {
    padding: 4px 6px;       /* padding lebih kecil */
    word-wrap: break-word;  /* teks panjang wrap */
    white-space: normal;    /* jangan paksa tetap 1 baris */
    font-size: 12px;        /* font lebih kecil */
  }
}



/* ================= FOOTER TABLE MOBILE ================= */
.footer-table table{
  margin-top:0;
  background:white;
  color:black; 
  min-width:auto; /* override */
}

@media(max-width:600px){
  .footer-table th,
  .footer-table td{
    font-size:12px;
    padding:6px;
  }
  
  @media(max-width:600px){
  .checkbox-card{
    padding:7px 9px;
    font-size:11px;
  }
}

  

 .footer h4{
  margin-bottom:6px;
  padding-bottom:4px;
  border-bottom:1px solid #e5e7eb;
}

  .footer h5{
    font-size:12px;
    text-align:center;
    color:#555;
  }
}

#tabelRekap{
  min-width:0;
  width:auto;
  table-layout:auto;
}

.table-wrap table{
  width:auto;
  min-width:0;
  table-layout:auto;
}

/* ===== PRINT SETTING ===== */
@media print{

  body{
    background:#fff;
  }

  .container > *:not(#hasil){
    display:none !important;
  }

  .print-area{
    display:none !important;
  }

  #hasil{
    display:block;
  }
   @page{
    size:A4 portrait;
    margin:12mm;
  }
  table{
    min-width:0 !important;
    table-layout:fixed;
  }

  th, td{
    font-size:11px;
    padding:6px;
    word-wrap:break-word;
  }
}

.btn-print{
  background:#16a34a;      /* hijau */
  color:#fff;
  border:none;
  border-radius:12px;
  padding:10px 16px;
  font-size:14px;
  cursor:pointer;
  transition:0.2s ease;
}

.btn-print:hover{
  background:#15803d;      /* hijau lebih gelap */
}

@media print {
  .logo-top-right {
    display: flex !important;
  }
}
@media print {
  body.perusahaan-mode #rekapProgram {
    display: none !important;
  }
}

/* ===== SEKTOR BPU DESKTOP ===== */
.sektor-bpu{
  display:flex;
  flex-wrap:nowrap;       /* desktop 1 baris */
  gap:12px;
  align-items:center;
}

.sektor-bpu .checkbox-card{
  white-space:nowrap;
  padding:6px 12px;
  font-size:12px;
}

/* ===== MOBILE ===== */
@media (max-width:600px){
  .sektor-bpu{
    flex-wrap:wrap;        /* mobile turun baris */
  }
  .sektor-bpu .checkbox-card{
    width:100%;           /* full lebar per baris */
    justify-content:flex-start;
    font-size:11px;
  }
}



</style>
</head>

<body>
<div class="container">

<div class="logo-top-right">
  <img src="logo.png" alt="Logo BPJS Ketenagakerjaan">
</div>

<h2>Simulasi Penganggaran Iuran Jaminan Sosial Ketenagakerjaan</h2>
<p style="text-align: justify"><font size="2px">Simulasi ini dapat digunakan oleh Pemerintah Daerah
	untuk membantu perencanaan dan estimasi kebutuhan anggaran perlindungan
	Jaminan Sosial Ketenagakerjaan. Dapat digunakan juga oleh Perusahaan untuk ikut serta dalam Program Sejahterakan Pekerja Sekitar Anda (SERTAKAN) segmen Bukan Penerima Upah (BPU).
 </font></p>
 
<!-- ================= TUJUAN SIMULASI ================= -->
<div class="section">
<div class="row-pengguna">

  <div class="checkbox-row">
    <div class="checkbox-card" id="cardPemda">
      <input type="checkbox" id="tujuanPemda">
      Pemerintah Daerah
    </div>

    <div class="checkbox-card" id="cardPerusahaan">
      <input type="checkbox" id="tujuanPerusahaan">
      Perusahaan
    </div>
  <button
    type="button"
    class="btn-reset-inline"
    onclick="resetSimulasi()">
    Reset
  </button>
  </div>

  </div>

</div>


 
 
<!-- ================= METODE ================= -->
<div class="section hidden" id="boxMetode">
  <label><b>Metode Simulasi</b></label>
  <select id="metode">
    <option value="">-- Pilih Metode --</option>
    <option value="sasaran">Sesuai Sasaran</option>
    <option value="anggaran">Sesuai Ketersediaan Anggaran</option>
  </select>
</div>

<!-- ================= PERUSAHAAN ================= -->
<div id="boxPerusahaan" class="section hidden">
 <h4>Sejahterakan Pekerja Sekitar Anda (SERTAKAN) </h4>
<p style="text-align: justify"><font size="2px">Sesuai Peraturan Pemerintah Nomor 50 Tahun 2025, Pemerintah memberikan 
<b>Relaksasi Iuran JKK-JKM 50%</b> bagi Peserta Baru dan Peserta Lanjutan segmen BPU (tidak termasuk bagi peserta BPU
yang iurannya bersumber dari APBN/APBD).
<br> - Pekerja BPU Sektor Transportasi - <b>Periode Januari 2026 s/d Maret 2027</b>
<br> - Pekerja BPU Sektor Non Transportasi - <b>Periode April 2026 s/d Desember 2026</b>

</font></p>
 
  <!-- SEKTOR BPU (PP 50/2025) -->
  <div id="boxSektorBPU">
    <h4>Pilih Sektor Pekerjaan BPU</h4>

   <div class="checkbox-row sektor-bpu">

  <div class="checkbox-card" id="cardTransport">
    <input type="radio" name="sektorBPU" id="sektorTransport">
    Transportasi (Ojek, Sopir, Kurir, dll)
  </div>

  <div class="checkbox-card" id="cardNonTransport">
    <input type="radio" name="sektorBPU" id="sektorNonTransport">
    Non Transportasi (Petani, Nelayan, Pedagang, dll)
  </div>

</div>

  </div>

  <!-- BULAN MULAI PERLINDUNGAN -->
<div id="boxBulanMulai" class="hidden">
  <label>Bulan Mulai Perlindungan</label>
  <select id="bulanMulai">
    <option value="">-- Pilih Bulan --</option>
    <option value="2026-02">Feb 2026</option>
    <option value="2026-03">Mar 2026</option>
    <option value="2026-04">Apr 2026</option>
    <option value="2026-05">Mei 2026</option>
    <option value="2026-06">Jun 2026</option>
    <option value="2026-07">Jul 2026</option>
    <option value="2026-08">Agu 2026</option>
    <option value="2026-09">Sep 2026</option>
    <option value="2026-10">Okt 2026</option>
    <option value="2026-11">Nov 2026</option>
    <option value="2026-12">Des 2026</option>
  </select>
</div>

<!-- LAMA PERLINDUNGAN -->
<div id="boxLamaPerlindungan" class="hidden">
  <label>Lama Perlindungan (bulan)</label>
  <input type="number" id="lamaPerlindungan" min="1" value="3">
</div>

<!-- JUMLAH PEKERJA PERUSAHAAN -->
<div id="boxOrgPerusahaan" class="hidden">
  <label>Jumlah Pekerja yang Dilindungi</label>
  <input type="text" id="orgPerusahaan" class="input-number" value="100">
</div>
<button onclick="hitungPerusahaan()"
        id="btnHitungPerusahaan"
        class="hidden">
  Hitung
</button>

</div>



<!-- ================= SASARAN ================= -->
<div id="boxSasaran" class="section hidden">
  <h3>Simulasi Sesuai Sasaran</h3>

  <label>Jenis Sasaran</label>
  <div class="checkbox-row">
    <div class="checkbox-card" id="cardPU"><input type="checkbox" id="s_nonasn"> PU</div>
    <div class="checkbox-card" id="cardBPU"><input type="checkbox" id="s_bpu"> BPU (Pekerja Rentan)</div>
  </div>

  <!-- PU -->
  <div id="sasaranNonASN" class="hidden">
    <h4>PU</h4>
	    <label>Upah (Rp)</label>
    <input type="text" id="upahS" class="input-number" value="3.000.000">

    <label>Jumlah Orang</label>
    <input type="text" id="orgSNon" class="input-number" value="100">

    <label>Bulan Perlindungan</label>
    <input type="text" id="blnSNon" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTPU"><input type="checkbox" id="jhtSNon"> Tambah JHT 5,7%</div>
      <div class="checkbox-card disabled" id="cardJPPU"><input type="checkbox" id="jpSNon" disabled> Tambah JP 3%</div>
    </div>
  </div>

  <!-- BPU -->
  <div id="sasaranBPU" class="hidden">
    <h4>BPU (Pekerja Rentan)</h4>

    <label>Jumlah Orang</label>
    <input type="text" id="orgSBPU" class="input-number" value="100">

    <label>Bulan Perlindungan</label>
    <input type="text" id="blnSBPU" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTBPU"><input type="checkbox" id="jhtSBPU"> Tambah JHT (Rp20.000)</div>
    </div>
  </div>

  <button onclick="hitungSasaran()">Hitung</button>
  
</div>

<!-- ================= ANGGARAN ================= -->
<div id="boxAnggaran" class="section hidden">
  <h3>Simulasi Sesuai Ketersediaan Anggaran</h3>

  <label>Total Anggaran (Rp)</label>
  <input type="text" id="totalAnggaran" class="input-number">

  <label>Jenis Sasaran</label>
  <div class="checkbox-row">
    <div class="checkbox-card" id="cardPUA"><input type="checkbox" id="a_nonasn"> PU</div>
    <div class="checkbox-card" id="cardBPUA"><input type="checkbox" id="a_bpu"> BPU (Pekerja Rentan)</div>
  </div>

  <label><font color="BLUE"><b>Pilih Kebutuhan Perhitungan</font></b></label>
  <select id="tujuan">
    <option value="">-- Pilih --</option>
    <option value="orang">Mencari Jumlah Orang</option>
    <option value="bulan">Mencari Bulan Perlindungan</option>
  </select>

  <!-- PU Anggaran -->
  <div id="angNonASN" class="hidden">
    <h4>PU</h4>

    <label>Upah (Rp)</label>
    <input type="text" id="upahA" class="input-number" value="3.000.000">

    <label id="lblOrgA">Jumlah Orang</label>
    <input type="text" id="orgA" class="input-number" value="100">

    <label id="lblBlnA">Bulan Perlindungan</label>
    <input type="text" id="blnA" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTA"><input type="checkbox" id="jhtA"> Tambah JHT 5,7%</div>
      <div class="checkbox-card disabled" id="cardJPA"><input type="checkbox" id="jpA" disabled> Tambah JP 3%</div>
    </div>
  </div>

  <!-- BPU Anggaran -->
  <div id="angBPU" class="hidden">
    <h4>BPU (Pekerja Rentan)</h4>

    <label id="lblOrgB">Jumlah Orang</label>
    <input type="text" id="orgB" class="input-number" value="100">

    <label id="lblBlnB">Bulan Perlindungan</label>
    <input type="text" id="blnB" class="input-number" value="12">

    <div class="checkbox-row">
      <div class="checkbox-card" id="cardJHTBA"><input type="checkbox" id="jhtB"> Tambah JHT (Rp20.000)</div>
    </div>
  </div>

  <button onclick="hitungAnggaran()">Hitung</button>
  
</div>

<!-- ================= HASIL ================= -->
<div id="hasil" class="section hidden">
  <h3>Hasil Simulasi</h3>

  <div class="table-wrap">
    <table id="tabel">
      <tr>
        <th>Segmen</th>
        <th>Jumlah Orang</th>
        <th>Jumlah Bulan</th>
		<th>Jumlah Program</th>
        <th>Iuran / Bulan</th>
        <th>Total Anggaran</th>
      </tr>
    </table>
  </div>

  <div class="summary" id="kesimpulan"></div>
  <div id="rekapProgram" class="section hidden">
  <h3>Rekap Iuran per Program</h3>

  <div class="table-wrap">
    <table id="tabelRekap">
      <tr>
        <th>Program</th>
        <th id="colPU">PU</th>
        <th id="colBPU">BPU</th>
        <th>Total</th>
      </tr>
    </table>
  </div>
</div>
<div class="print-area hidden" id="printArea">
  <button onclick="printHasil()" class="btn-print">
    üñ®Ô∏è Cetak Hasil Simulasi
  </button>
</div>
</div>




<div class="footer">
  <h4>Skema Iuran</h4>
  <div class="table-wrap footer-table">
    <table>
      <tr><th>Program</th><th>Penerima Upah</th><th>Bukan Penerima Upah</th></tr>
      <tr><td>JKK + JKM</td><td>0,54% x Upah</td><td>Rp16.800</td></tr>
      <tr><td>JHT</td><td>5,7% x Upah</td><td>Rp20.000</td></tr>
      <tr><td>JP</td><td>3% x Upah</td><td>-</td></tr>
    </table>
  </div>

<p class="Catatan">
  <font size="1,5px">Keterangan : <br>
  - Jaminan Kecelakaan Kerja (JKK) | Jaminan Kematian (JKM) | Jaminan Hari Tua (JHT) | Jaminan Pensiun (JP) <br>
  - 2 Program (JKK, JKM) | 3 Program (JKK, JKM, JHT) | 4 Program (JKK, JKM, JHT, JP) <br>
  - Simulasi JKK yang digunakan adalah rate 0,24% <br>
  - Dasar Upah BPU yang digunakan Rp 1.000.000,-<br>
  - Minimal 2 Program Wajib (JKK + JKM) <br>
  - Brosur Manfaat Program BPJS Ketenagakerjaan
    <a href="https://drive.google.com/file/d/1JkoL7o6aFq8yeSEdYyYzTttSYZzUFHKf/view?usp=sharing"
       target="_blank" rel="noopener" >
      (Download) </a>  
    
  </font><br>
  
  
</p>
 
</div>

<div class="footer-note">¬© 2026. BPJS Ketenagakerjaan Kantor Wilayah Jawa Timur</div>

</div>

<script>

/* ================= INIT DOM ================= */
const boxBulanMulai = document.getElementById('boxBulanMulai');
const boxLamaPerlindungan = document.getElementById('boxLamaPerlindungan');
const bulanMulai = document.getElementById('bulanMulai');
const lamaPerlindungan = document.getElementById('lamaPerlindungan');
const boxOrgPerusahaan = document.getElementById('boxOrgPerusahaan');
const orgPerusahaan = document.getElementById('orgPerusahaan');

const cardPemda = document.getElementById('cardPemda');
const cardPerusahaan = document.getElementById('cardPerusahaan');
const tujuanPemda = document.getElementById('tujuanPemda');
const tujuanPerusahaan = document.getElementById('tujuanPerusahaan');

const boxMetode = document.getElementById('boxMetode');
const metode = document.getElementById('metode');
const hasil = document.getElementById('hasil');

/* ================= AUTO BIND DOM LENGKAP ================= */
const btnHitungPerusahaan = document.getElementById('btnHitungPerusahaan');
const boxSektorBPU = document.getElementById('boxSektorBPU');
const sektorTransport = document.getElementById('sektorTransport');
const sektorNonTransport = document.getElementById('sektorNonTransport');
const cardTransport = document.getElementById('cardTransport');
const cardNonTransport = document.getElementById('cardNonTransport');

// === EVENT SEKTOR ‚Üí tampilkan input lanjutan ===
sektorTransport.addEventListener('change', () => {
  boxBulanMulai.classList.remove('hidden');
  boxLamaPerlindungan.classList.remove('hidden');
  boxOrgPerusahaan.classList.remove('hidden');
  cekReadyHitungPerusahaan();
});

sektorNonTransport.addEventListener('change', () => {
  boxBulanMulai.classList.remove('hidden');
  boxLamaPerlindungan.classList.remove('hidden');
  boxOrgPerusahaan.classList.remove('hidden');
  cekReadyHitungPerusahaan();
});

let sektorBPU = null; // 'transport' | 'nontransport'
const cardPU = document.getElementById('cardPU');
const cardBPU = document.getElementById('cardBPU');
const sasaranNonASN = document.getElementById('sasaranNonASN');
const sasaranBPU = document.getElementById('sasaranBPU');

const jhtSNon = document.getElementById('jhtSNon');
const jpSNon  = document.getElementById('jpSNon');
const jhtSBPU = document.getElementById('jhtSBPU');

const cardJHTPU = document.getElementById('cardJHTPU');
const cardJPPU  = document.getElementById('cardJPPU');
const cardJHTBPU = document.getElementById('cardJHTBPU');

const cardPUA = document.getElementById('cardPUA');
const cardBPUA = document.getElementById('cardBPUA');
const angNonASN = document.getElementById('angNonASN');
const angBPU = document.getElementById('angBPU');

const jhtA = document.getElementById('jhtA');
const jpA  = document.getElementById('jpA');
const jhtB = document.getElementById('jhtB');

const cardJHTA = document.getElementById('cardJHTA');
const cardJPA  = document.getElementById('cardJPA');
const cardJHTBA = document.getElementById('cardJHTBA');

const tujuan = document.getElementById('tujuan');
const lblOrgA = document.getElementById('lblOrgA');
const lblOrgB = document.getElementById('lblOrgB');
const lblBlnA = document.getElementById('lblBlnA');
const lblBlnB = document.getElementById('lblBlnB');
const orgA = document.getElementById('orgA');
const orgB = document.getElementById('orgB');
const blnA = document.getElementById('blnA');
const blnB = document.getElementById('blnB');

const boxPerusahaan = document.getElementById('boxPerusahaan');





/* ================= TUJUAN SIMULASI ================= */
let modeTujuan = ''; // 'pemda' | 'perusahaan'

function setTujuan(tipe){

 resetFlow(); // ‚¨ÖÔ∏è INI KUNCI NYA


  if(tipe === 'pemda'){
    tujuanPemda.checked = true;
    tujuanPerusahaan.checked = false;
    modeTujuan = 'pemda';

    cardPemda.classList.add('active');
    cardPerusahaan.classList.remove('active');
  }

  if(tipe === 'perusahaan'){
    tujuanPerusahaan.checked = true;
    tujuanPemda.checked = false;
    modeTujuan = 'perusahaan';

    cardPerusahaan.classList.add('active');
    cardPemda.classList.remove('active');
  }

  // METODE ‚Üí hanya PEMDA
  if(tipe === 'pemda'){
    boxMetode.classList.remove('hidden');
  }else{
    boxMetode.classList.add('hidden');
  }

  // BOX PERUSAHAAN
  if(tipe === 'perusahaan'){
    boxPerusahaan.classList.remove('hidden');
  }else{
    boxPerusahaan.classList.add('hidden');
  }

  hasil.classList.add('hidden');
  metode.value = '';

  console.log('MODE:', modeTujuan);
}

// 4. FUNGSI KHUSUS PERUSAHAAN
// ============================



// DEFAULT MODE = PEMDA
setTujuan('pemda');
cardPemda.onclick = () => setTujuan('pemda');
cardPerusahaan.onclick = () => setTujuan('perusahaan');

tujuanPemda.onclick = e => {
  e.stopPropagation();
  setTujuan('pemda');
};

tujuanPerusahaan.onclick = e => {
  e.stopPropagation();
  setTujuan('perusahaan');
};


const format=n=>Number(n||0).toLocaleString('id-ID');
const getNum=id=>parseInt(document.getElementById(id).value.replace(/\./g,''))||0;

/* format input */
document.addEventListener('input',e=>{
  if(e.target.classList.contains('input-number')){
    let raw=e.target.value.replace(/[^0-9]/g,'');
    e.target.value=format(raw);
  }
});

/* ================= METODE ================= */
metode.onchange=()=>{
 if(modeTujuan !== 'pemda'){
    alert('Metode ini hanya untuk Pemerintah Daerah');
    metode.value = '';
    return;
  }

  boxSasaran.classList.add('hidden');
  boxAnggaran.classList.add('hidden');
  hasil.classList.add('hidden');

  if(metode.value === 'sasaran') boxSasaran.classList.remove('hidden');
  if(metode.value === 'anggaran') boxAnggaran.classList.remove('hidden');
};
/* ================= TOGGLE SASARAN ================= */
s_nonasn.onchange=()=>{
  cardPU.classList.toggle('active',s_nonasn.checked);
  sasaranNonASN.classList.toggle('hidden',!s_nonasn.checked);
};

s_bpu.onchange=()=>{
  cardBPU.classList.toggle('active',s_bpu.checked);
  sasaranBPU.classList.toggle('hidden',!s_bpu.checked);
};

/* JHT ‚Üí JP PU */
jhtSNon.onchange=()=>{
  cardJHTPU.classList.toggle('active',jhtSNon.checked);
  jpSNon.disabled=!jhtSNon.checked;
  cardJPPU.classList.toggle('disabled',!jhtSNon.checked);
  if(!jhtSNon.checked){jpSNon.checked=false;cardJPPU.classList.remove('active')}
};

jpSNon.onchange=()=>cardJPPU.classList.toggle('active',jpSNon.checked);

jhtSBPU.onchange=()=>cardJHTBPU.classList.toggle('active',jhtSBPU.checked);

/* ================= TOGGLE ANGGARAN ================= */
a_nonasn.onchange=()=>{
  cardPUA.classList.toggle('active',a_nonasn.checked);
  angNonASN.classList.toggle('hidden',!a_nonasn.checked);
};

a_bpu.onchange=()=>{
  cardBPUA.classList.toggle('active',a_bpu.checked);
  angBPU.classList.toggle('hidden',!a_bpu.checked);
};

jhtA.onchange=()=>{
  cardJHTA.classList.toggle('active',jhtA.checked);
  jpA.disabled=!jhtA.checked;
  cardJPA.classList.toggle('disabled',!jhtA.checked);
  if(!jhtA.checked){jpA.checked=false;cardJPA.classList.remove('active')}
};

jpA.onchange=()=>cardJPA.classList.toggle('active',jpA.checked);

jhtB.onchange=()=>cardJHTBA.classList.toggle('active',jhtB.checked);

/* tujuan */
tujuan.onchange=()=>{
  const orang=tujuan.value==='bulan';
  lblOrgA.style.display=orang?'block':'none';
  orgA.style.display=orang?'block':'none';
  lblOrgB.style.display=orang?'block':'none';
  orgB.style.display=orang?'block':'none';
  lblBlnA.style.display=orang?'none':'block';
  blnA.style.display=orang?'none':'block';
  lblBlnB.style.display=orang?'none':'block';
  blnB.style.display=orang?'none':'block';
};
function resetFlow(){

  // reset metode
  metode.value = '';
  boxSasaran.classList.add('hidden');
  boxAnggaran.classList.add('hidden');

  // reset sasaran PEMDA
  s_nonasn.checked = false;
  s_bpu.checked = false;
  cardPU.classList.remove('active');
  cardBPU.classList.remove('active');
  sasaranNonASN.classList.add('hidden');
  sasaranBPU.classList.add('hidden');

  // reset anggaran PEMDA
  a_nonasn.checked = false;
  a_bpu.checked = false;
  cardPUA.classList.remove('active');
  cardBPUA.classList.remove('active');
  angNonASN.classList.add('hidden');
  angBPU.classList.add('hidden');

  // reset hasil
  hasil.classList.add('hidden');
  document.getElementById('printArea').classList.add('hidden');

  // reset rekap
  
  rekapProgram.classList.add('hidden');
  tabel.innerHTML = tabel.rows[0].outerHTML;
  tabelRekap.innerHTML = tabelRekap.rows[0].outerHTML;
}

/* ================= HITUNG ================= */

function hitungJumlahProgram({ jht=false, jp=false }){
  let jumlah = 2; // default JKK + JKM
  if(jht) jumlah++;
  if(jp) jumlah++;
  return jumlah + 'P';
}


function hitungSasaran(){
   if(modeTujuan !== 'pemda'){
    alert('Simulasi sasaran ini hanya untuk Pemerintah Daerah');
    return;
  }

  console.log('MODE:', modeTujuan);
  tabel.innerHTML=tabel.rows[0].outerHTML;
  let total=0;

  if(s_nonasn.checked){
    let up=getNum('upahS'),org=getNum('orgSNon'),bln=getNum('blnSNon');
    let tarif=0.0054+(jhtSNon.checked?0.057:0)+(jpSNon.checked?0.03:0);
    let per=up*tarif,sub=per*org*bln;total+=sub;
	
	 let jumlahProgram = hitungJumlahProgram({
    jht: jhtSNon.checked,
    jp:  jpSNon.checked
  });
	
	
    tabel.innerHTML+=`	<tr><td>PU</td>
	<td>${format(org)}</td>
	<td>${format(bln)}</td>
	<td>${jumlahProgram}</td>
	<td>Rp ${format(per)}</td>
	<td>Rp ${format(sub)}</td></tr>`;
  }

  if(s_bpu.checked){
    let org=getNum('orgSBPU'),bln=getNum('blnSBPU');
    let per=16800+(jhtSBPU.checked?20000:0),sub=per*org*bln;
	total+=sub;
	
	let jumlahProgram = hitungJumlahProgram({
    jht: jhtSBPU.checked
  });
	
    tabel.innerHTML+=`
	<tr><td>BPU</td>
	<td>${format(org)}</td>
	<td>${format(bln)}</td>
	<td>${jumlahProgram}</td>
	<td>Rp ${format(per)}</td>
	<td>Rp ${format(sub)}</td>
	</tr>`;
  }

  tabel.innerHTML+=`<tr><th colspan="5">TOTAL</th><th>Rp ${format(total)}</th></tr>`;
  
  
  let totalOrang = 0;
if(s_nonasn.checked) totalOrang += getNum('orgSNon');
if(s_bpu.checked)    totalOrang += getNum('orgSBPU');

kesimpulan.innerHTML =
`Hasil simulasi menunjukkan kebutuhan anggaran sebesar 
<b>Rp ${format(total)}</b> untuk perlindungan 
<b>${format(totalOrang)} </b> peserta program jaminan sosial ketenagakerjaan 
sesuai skema yang dipilih.`;
  let rekapPU = {};
let rekapBPU = {};

// PU
if(s_nonasn.checked){
  let up = getNum('upahS');
  let org = getNum('orgSNon');
  let bln = getNum('blnSNon');

  rekapPU.JKK = up * 0.0024 * org * bln;
  rekapPU.JKM = up * 0.003 * org * bln;
  if(jhtSNon.checked) rekapPU.JHT = up * 0.057 * org * bln;
  if(jpSNon.checked) rekapPU.JP  = up * 0.03  * org * bln;


}

// BPU
if(s_bpu.checked){
  let org = getNum('orgSBPU');
  let bln = getNum('blnSBPU');

  rekapBPU.JKK = 10000 * org * bln;
  rekapBPU.JKM = 6800  * org * bln;
  if(jhtSBPU.checked) rekapBPU.JHT = 20000 * org * bln;



}

tampilkanRekap({ pu: rekapPU, bpu: rekapBPU });

  
  hasil.classList.remove('hidden');
  document.getElementById('printArea').classList.remove('hidden');
}

function hitungAnggaran(){

  if(modeTujuan !== 'pemda'){
    alert('Simulasi anggaran ini hanya untuk Pemerintah Daerah');
    return;
  }

  console.log('MODE:', modeTujuan);
  tabel.innerHTML = tabel.rows[0].outerHTML;
  let ang = getNum('totalAnggaran');
  let bagian = (a_nonasn.checked && a_bpu.checked) ? ang/2 : ang;
  let total = 0;

  let rekapPU = {};
  let rekapBPU = {};

  /* ================= PU ================= */
  if(a_nonasn.checked){
    let up = getNum('upahA');
    let org = getNum('orgA');
    let bln = getNum('blnA');

    let tarifJKK = 0.0024;
    let tarifJKM = 0.003;
    let tarifJHT = jhtA.checked ? 0.057 : 0;
    let tarifJP  = jpA.checked  ? 0.03  : 0;

    let tarifTotal = tarifJKK + tarifJKM + tarifJHT + tarifJP;

    if(tujuan.value === 'orang'){
      let biayaPerOrg = up * tarifTotal * bln;
      org = Math.floor(bagian / biayaPerOrg);
    }else{
      let biayaPerBln = up * tarifTotal * org;
      bln = Math.floor(bagian / biayaPerBln);
    }

    let sub = up * tarifTotal * org * bln;
    total += sub;

    /* üîπ REKAP PU */
    rekapPU.JKK = up * tarifJKK * org * bln;
    rekapPU.JKM = up * tarifJKM * org * bln;
    if(jhtA.checked) rekapPU.JHT = up * tarifJHT * org * bln;
    if(jpA.checked)  rekapPU.JP  = up * tarifJP  * org * bln;

let jumlahProgram = hitungJumlahProgram({
  jht: jhtA.checked,
  jp: jpA.checked
});

    tabel.innerHTML += `
      <tr>
        <td>PU</td>
        <td>${format(org)}</td>
        <td>${format(bln)}</td>
		<td>${jumlahProgram}</td>
        <td>Rp ${format(up * tarifTotal)}</td>
        <td>Rp ${format(sub)}</td>
      </tr>
    `;
  }

  /* ================= BPU ================= */
  if(a_bpu.checked){
    let org = getNum('orgB');
    let bln = getNum('blnB');

    let tarifJKK = 10000;
	let tarifJKM = 6800;
	let tarifJHT = jhtB.checked ? 20000 : 0;
	let tarifTotal = tarifJKK + tarifJKM + tarifJHT;

    if(tujuan.value === 'orang'){
      org = Math.floor(bagian / (tarifTotal * bln));
    }else{
      bln = Math.floor(bagian / (tarifTotal * org));
    }

    let sub = tarifTotal * org * bln;
    total += sub;

    /* üîπ REKAP BPU */
   rekapBPU.JKK = 10000 * org * bln;
rekapBPU.JKM = 6800  * org * bln;
if(jhtB.checked) rekapBPU.JHT = 20000 * org * bln;


let jumlahProgram = hitungJumlahProgram({
  jht: jhtB.checked
});

    tabel.innerHTML += `
      <tr>
        <td>BPU</td>
        <td>${format(org)}</td>
        <td>${format(bln)}</td>
		<td>${jumlahProgram}</td>
        <td>Rp ${format(tarifTotal)}</td>
        <td>Rp ${format(sub)}</td>
      </tr>
    `;
  }

let sisa = ang - total;

/* BARIS TOTAL */
tabel.innerHTML += `
  <tr>
    <th colspan="5">TOTAL</th>
    <th>Rp ${format(total)}</th>
  </tr>
`;

/* BARIS SISA ANGGARAN */
tabel.innerHTML += `
  <tr>
    <th colspan="5">SISA ANGGARAN</th>
    <th>Rp ${format(sisa)}</th>
  </tr>
`;

  kesimpulan.innerHTML = `
    Total anggaran <b>Rp ${format(ang)}</b>,
    digunakan <b>Rp ${format(total)}</b>,
    sisa <b>Rp ${format(sisa)}</b>.
  `;

  /* üî• INI KUNCI REKAP */
  tampilkanRekap({
    pu: rekapPU,
    bpu: rekapBPU
  });

  hasil.classList.remove('hidden');
  document.getElementById('printArea').classList.remove('hidden');

}

function hitungPerusahaan(){

  if(modeTujuan !== 'perusahaan'){
    alert('Mode perusahaan belum dipilih');
    return;
  }


  // pastikan sektor dipilih
  let sektor = null;
  if(sektorTransport.checked) sektor = 'transport';
  if(sektorNonTransport.checked) sektor = 'nontransport';

  if(!sektor){
    alert('Pilih sektor pekerjaan BPU');
    return;
  }

  // pastikan bulan mulai & lama dipilih
  if(!bulanMulai.value){
    alert('Pilih bulan mulai perlindungan');
    return;
  }

  let lama = parseInt(lamaPerlindungan.value);
  if(!lama || lama < 1){
    alert('Isi lama perlindungan');
    return;
  }

  

  // ====== PERHITUNGAN ======
  let org = getNum('orgPerusahaan');
if(!org || org < 1) org = 1;
 let tarifJKKJKM_Normal = 16800;
let tarifJKKJKM_Diskon = 8400; // 50%

let tarifJHT = jhtSBPU.checked ? 20000 : 0;

let total = 0;

let totalNormal = 0;
let totalDiskon = 0;
let bulanNormal = 0;
let bulanDiskon = 0;

// hitung per bulan
for(let i=0; i<lama; i++){

  // tentukan tanggal bulan ke-i
  let tgl = new Date(bulanMulai.value + '-01');
  tgl.setMonth(tgl.getMonth() + i);

  let tarifJKKJKM = tarifJKKJKM_Normal; // default normal

  // === CEK PERIODE DISKON ===
  if(sektor === 'transport'){
    if(tgl >= new Date('2026-01-01') && tgl <= new Date('2027-03-31')){
      tarifJKKJKM = tarifJKKJKM_Diskon;
    }
  }

  if(sektor === 'nontransport'){
    if(tgl >= new Date('2026-04-01') && tgl <= new Date('2026-12-31')){
      tarifJKKJKM = tarifJKKJKM_Diskon;
    }
  }

  let tarifBulanIni = tarifJKKJKM + tarifJHT;
let subtotal = tarifBulanIni * org;

total += subtotal;

// === REKAP KONDISI ===
if(tarifJKKJKM === tarifJKKJKM_Diskon){
  totalDiskon += subtotal;
  bulanDiskon++;
}else{
  totalNormal += subtotal;
  bulanNormal++;
}
}


  // ====== TAMPILKAN HASIL ======
  tabel.innerHTML = `
    <tr>
      <th>Kategori</th>
      <th>Jumlah Orang</th>
      <th>Jumlah Bulan</th>
      <th>Jumlah Program</th>
      <th>Iuran / Bulan</th>
      <th>Total Iuran</th>
    </tr>

   ${bulanNormal > 0 ? `
<tr>
  <td>Iuran Normal</td>
  <td>${format(org)}</td>
  <td>${format(bulanNormal)}</td>
  <td>${jhtSBPU.checked ? '3P' : '2P'}</td>
  <td>Rp ${format((totalNormal / (org * bulanNormal)).toFixed(0))}</td>
  <td>Rp ${format(totalNormal)}</td>
</tr>` : ''}

${bulanDiskon > 0 ? `
<tr>
  <td>Iuran Relaksasi 50%</td>
  <td>${format(org)}</td>
  <td>${format(bulanDiskon)}</td>
  <td>${jhtSBPU.checked ? '3P' : '2P'}</td>
  <td>Rp ${format((totalDiskon / (org * bulanDiskon)).toFixed(0))}</td>
  <td>Rp ${format(totalDiskon)}</td>
</tr>` : ''}

<tr>
  <th colspan="5">TOTAL</th>
  <th>Rp ${format(total)}</th>
</tr>
  `;

  kesimpulan.innerHTML =
`Simulasi SERTAKAN untuk ${format(org)} pekerja selama ${lama} bulan:
<ul>
<li>${bulanNormal} bulan iuran normal ‚Üí Rp ${format(totalNormal)}</li>
<li>${bulanDiskon} bulan iuran relaksasi 50% ‚Üí Rp ${format(totalDiskon)}</li>
</ul>
<b>Total iuran yang dianggarkan: Rp ${format(total)}</b>`;

rekapProgram.classList.add('hidden');
  hasil.classList.remove('hidden');
  document.getElementById('printArea').classList.remove('hidden');
}

function cekReadyHitungPerusahaan(){
  if(modeTujuan !== 'perusahaan') return;


  // sektor dipilih
  let sektorOK = sektorTransport.checked || sektorNonTransport.checked;

  // bulan mulai terisi
  let bulanOK = bulanMulai.value !== '';

  // lama valid
  let lamaOK = lamaPerlindungan.value !== '' && parseInt(lamaPerlindungan.value) > 0;
	let orgOK = orgPerusahaan.value !== '' && getNum('orgPerusahaan') > 0;

  if(sektorOK && bulanOK && lamaOK && orgOK){
    btnHitungPerusahaan.classList.remove('hidden');
  }else{
    btnHitungPerusahaan.classList.add('hidden');
  }
}
// setiap input berubah ‚Üí cek tombol
sektorTransport.onchange = cekReadyHitungPerusahaan;
sektorNonTransport.onchange = cekReadyHitungPerusahaan;
bulanMulai.onchange = cekReadyHitungPerusahaan;
lamaPerlindungan.oninput = cekReadyHitungPerusahaan;
function tampilkanRekap({pu = {}, bpu = {}}){

  const hasPU  = Object.keys(pu).length > 0;
  const hasBPU = Object.keys(bpu).length > 0;

  tabelRekap.innerHTML = `
    <tr>
      <th>Program</th>
      ${hasPU ? '<th id="colPU">PU</th>' : ''}
      ${hasBPU ? '<th id="colBPU">BPU</th>' : ''}
      <th>Total</th>
    </tr>
  `;

  const program = ['JKK','JKM','JHT','JP'];
  let grandTotal = 0;

  program.forEach(p=>{
    let valPU  = pu[p]  || 0;
    let valBPU = bpu[p] || 0;
    let total  = valPU + valBPU;

    if(total === 0) return;

    grandTotal += total;

    tabelRekap.innerHTML += `
      <tr>
        <td>${p}</td>
        ${hasPU  ? `<td>Rp ${format(valPU)}</td>`  : ''}
        ${hasBPU ? `<td>Rp ${format(valBPU)}</td>` : ''}
        <td><b>Rp ${format(total)}</b></td>
      </tr>
    `;
  });

  const colspan = 1 + (hasPU ? 1 : 0) + (hasBPU ? 1 : 0);

  tabelRekap.innerHTML += `
    <tr>
      <th colspan="${colspan}">TOTAL</th>
      <th>Rp ${format(grandTotal)}</th>
    </tr>
  `;

  rekapProgram.classList.remove('hidden');
}



function printHasil(){
  document.getElementById('hasil').classList.remove('hidden');

  // üîπ Rekap hanya ditampilkan jika mode PEMDA
  if(modeTujuan === 'pemda'){
    document.getElementById('rekapProgram').classList.remove('hidden');
  }else{
    document.getElementById('rekapProgram').classList.add('hidden');
  }

  window.print();
}
function resetSimulasi(){
  window.location.reload();
}
</script>
</body>
</html>



